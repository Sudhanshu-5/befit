<!-- <%=calorieinfo.macroNutrientInfo%> -->
<p id="date-absence">
  No record is added for this date !!
</p>
<div class="container">
<canvas id="calorieChart"></canvas>
</div>
<script>
 
  <% let fromIndex=0;%>
  <% let toIndex=0; %>
         
 consumedArray=[];
 burnedArray=[];
 dates=[];
 macro=[];
type=<%-JSON.stringify(type)%> 

$("#date-absence").hide();

		length = <%-calorieinfo.macroNutrientInfo.length%>;



// console.log("yesterdaytttttttttttttt "+yesterday.toLocaleDateString())
// console.log("todayyyyyyyyyyyyyy "+today.toLocaleDateString());
var ctx = document.getElementById("calorieChart").getContext("2d");


	if(<%-JSON.stringify(selected)%> == "today"){
            let today_dates  ;
            let info_date;
            let count=0;

      <%calorieinfo.macroNutrientInfo.forEach(function(info){%>
        today_dates=today.toLocaleDateString();
        info_date=<%-JSON.stringify((new Date(info.createdAt)).toLocaleDateString())%>;
                  if(  today_dates === info_date){
                    // console.log(typeof(today.toLocaleDateString())+"   "+typeof(<%-JSON.stringify((new Date(info.createdAt)).toLocaleDateString())%>)
                    dates.push('<%-(new Date(info.createdAt)).toLocaleDateString()%>');

                    if(<%-JSON.stringify(type)%>=="calories"){
                       
                        consumedArray.push('<%-info.totalCaloriesConsumed%>');
                        burnedArray.push('<%-info.totalCaloriesBurned%>')
                    }
                    else{
                      console.log("ye wal")
                      macro.push(<%-JSON.stringify(info)%>[type])
                     
                    }
                     count++;
                   }
                 
                   
             <%})%>
             if(!count){
               $("#date-absence").show();
             }
		}
	

		else if(<%-JSON.stringify(selected)%> == "yesterday"){           
            let count=0;
            <%calorieinfo.macroNutrientInfo.forEach(function(info){%>
                   if( yesterday.toLocaleDateString() == '<%-(new Date(info.createdAt)).toLocaleDateString()%>'){
                       dates.push('<%-(new Date(info.createdAt)).toLocaleDateString()%>');
		        
                    if(<%-JSON.stringify(type)%>=="calories"){
                       	consumedArray.push('<%-info.totalCaloriesConsumed%>');
                         burnedArray.push('<%-info.totalCaloriesBurned%>')
                    }
                    else{
                     macro.push(<%-JSON.stringify(info)%>[type])
                    }
                     count++;
                  
                   }
                  
             <%})%>
            if(!count){
               $("#date-absence").show();
             }
			      
      }
      else if(<%-JSON.stringify(selected)%> == "stom" && <%-JSON.stringify(from)%> && <%-JSON.stringify(to)%>){
         console.log("inside custpm")
        <% for(let i=0 ; i<calorieinfo.macroNutrientInfo.length  ; i++){ %>
          //  console.log("andar"+<%-fromIndex%>)
// console.log(<%-JSON.stringify(calorieinfo.macroNutrientInfo[i]["createdAt"].toLocaleDateString())%>+"  =============  "+ <%-JSON.stringify(from)%>)
            <%if(JSON.stringify(calorieinfo.macroNutrientInfo[i]["createdAt"].toLocaleDateString()) === JSON.stringify(from)){%> 
              <%-fromIndex=i%>;
              valid_from=<%-i%>;
            console.log(<%-fromIndex%>+"fromIndex"+typeof(<%-fromIndex%>))
            <% }%>
// console.log(<%-JSON.stringify(calorieinfo.macroNutrientInfo[i]["createdAt"].toLocaleDateString())%>+" 2 =============  "+ <%-JSON.stringify(to)%>)

          <%if(JSON.stringify(calorieinfo.macroNutrientInfo[i]["createdAt"].toLocaleDateString()) === JSON.stringify(to)){%>
            <%-toIndex=i%>
            valid_to=<%-i%>;
           console.log(valid_to+"toindex")
            <%}%>

        <%}%>
        console.log("nkjndankds "+valid_to+"   "+valid_from);
             if(valid_to >=0){
               <% for(let i=fromIndex;i<=toIndex; i++){%>
                     console.log("111111111111111111 "+<%-i%>);      
              dates.push(<%-JSON.stringify((new Date(calorieinfo.macroNutrientInfo[i]["createdAt"]).toLocaleDateString()))%>);
		        	
              if(<%-JSON.stringify(type)%>=="calories"){
              consumedArray.push(<%-JSON.stringify(calorieinfo.macroNutrientInfo[i]["totalCaloriesConsumed"])%>);
              burnedArray.push(<%-JSON.stringify(calorieinfo.macroNutrientInfo[i]["totalCaloriesBurned"])%>)
                    }
                    else{
                        macro.push(<%-JSON.stringify(info)%>[type])
                    }
               <% }%>
            }
            else{
              $("#date-absence").show();
             
            }


              
      	}

else{
    <%calorieinfo.macroNutrientInfo.forEach(function(info){%>
              console.log("date "+'<%-(new Date(info.createdAt)).toLocaleDateString()%>')
			        dates.push('<%-(new Date(info.createdAt)).toLocaleDateString()%>');
		        	
                 if(<%-JSON.stringify(type)%>=="calories"){
                     consumedArray.push('<%-info.totalCaloriesConsumed%>');
                      burnedArray.push('<%-info.totalCaloriesBurned%>');
                    }
                    else{
                        macro.push(<%-JSON.stringify(info)%>[type])
                    }
              
                 
		<%})%>
    }
if(<%-JSON.stringify(type)%>=="calories"){    
var data = {
  labels:dates,
  datasets: [{
    label: "calories consumed",
    backgroundColor: "#FF652F",
    data:consumedArray
  }, {
    label: "Burned calories",
    backgroundColor: "#14A76C",
    data: burnedArray
  }]
};
var myBarChart = new Chart(ctx, {
  type: 'bar',
  data: data,
  options: {
    maintainAspectRatio: false,
    scales: {
       xAxes: [{
         	scaleLabel: {
					display: true,
					labelString: 'Dates'
				},
            barThickness : 73
        }],
      yAxes: [{
          	scaleLabel: {
					display: true,
					labelString: 'Calories in KCal'
				},
        ticks: {
          min: 0,
          max:3500
        }
      }]
    }
  }
});
}else{
  var myBarChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: dates,
        datasets: [{
            label: 'Series 1', // Name the series
            data:macro,
            fill: false,
            borderColor: '#2196f3', // Add custom color border (Line)
            backgroundColor: '#2196f3', // Add custom color background (Points and Fill)
            borderWidth: 1 // Specify bar border width
        }]
    },
    options: {
      // responsive: false ,// Instruct chart js to respond nicely.
       maintainAspectRatio: true, // Add to prevent default behaviour of full-width/height 
    }
});
}
</script>


